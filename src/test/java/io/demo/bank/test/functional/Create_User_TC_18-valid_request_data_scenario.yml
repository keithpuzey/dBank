
execution:
  - scenario: 'Create User TC 18 - valid request data'
    locations:
      harbor-59464ffd67f3bf63cb7b23c9: 1
scenarios:
  Create_User_TC_18-valid_request_data:
    follow-redirects: true
    requests:
      - url: '/bank/api/v1/auth?username=admin@demo.io&password=Demo123!'
        method: POST
        label: 2. Authenticate API User
        headers:
          Content-Type: application/json
        assert:
         - contains:
           - '200'
           subject: http-code
           regexp: true
           assume-success: true
        extract-jsonpath:
          authToken: 'authToken'
      - url: '/bank//api/v1/user?role=API'
        method: POST
        label: 3. Create API User
        headers:
          Authorization: Bearer ${authToken}
          Content-Type: application/json
        body: '{ "address": "^data_address^", "country": "^data_country^", "dob": "^data_dob^", "emailAddress": "^data_email_address^", "firstName": "^data_first_name^", "gender": "^data_gender^", "homePhone": "^data_phone_home^", "lastName": "^data_last_name^", "locality": "^data_locality^", "mobilePhone": "^data_phone_mobile^", "password": "^data_password^", "postalCode": "^data_postal_code^", "region": "^data_region^", "ssn": "^data_ssn^", "title": "^data_title^", "workPhone": "^data_phone_work^" }'
        assert:
         - contains:
           - '201'
           subject: http-code
           regexp: true
           assume-success: true
        extract-jsonpath:
          userId: 'id'
        extract-jsonpath:
          username: 'username'
        extract-jsonpath:
          id: id
      - url: '/bank/api/v1/user/${id}'
        method: DELETE
        label: 5. Delete API User
        headers:
          Authorization: 'Bearer ${authToken}'
          Content-Type: application/json
        assert:
          - subject: http-code
            regexp: true
            contains:
              - '204'
    default-address: 'http://dbank.dbankdemo.com:8080'
